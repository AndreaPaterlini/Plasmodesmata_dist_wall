<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Wall Thickness</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Data analysis</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Welcome</a>
</li>
<li>
  <a href="preliminary.html">Preliminary steps</a>
</li>
<li>
  <a href="distributions.html">Distributions</a>
</li>
<li>
  <a href="clusters.html">Clusters</a>
</li>
<li>
  <a href="surfaces.html">Surfaces</a>
</li>
<li>
  <a href="wall.html">Cell wall</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Wall Thickness</h1>

</div>


<p><br></p>
<p>In this section we shift to a different biological question and we employ the last plugin developed for the Paterlini, Belevich et al. paper. Using the <em>CellWallThickness</em> plugin we will try to address the biological question of cell wall thickness around Plasmodesmata (or similar types of annotations along a given model). We ask: <strong>Is the cell wall in proximity of plasmodesmata different (in terms of thickness) compared to the wall average?</strong></p>
<p><br></p>
<div id="run3" class="section level1">
<h1>Run the <em>CellWallThickness</em> plugin</h1>
<p><br></p>
<p>Make sure you have loaded your datasets, models and annotations as described in in the <a href="preliminary.html">Preliminary Steps section</a>.</p>
<p>From the MIB interface go to the <em>Plugins</em> tab -&gt; <em>Plasmodesmata</em> -&gt; <em>CellWallThickness</em>. A user interface will appear with fields to be filled in.</p>
<ul>
<li>“Select material for analysis” requires you to choose the correct segmented object for analysis</li>
<li><em>Thin and remove branches</em> button within the pre-processing box generates a midline of the model (in presence of branching points, keeps the longest branch) and temporarily stores it in the Mask layer of the <em>.model</em> file. For more details please see the paper.</li>
</ul>
<p>A series of options are available for the analysis:</p>
<ul>
<li>Selecting “Analysis of pores” calculates the cell wall thickness in proximity of the plasmodesmata (or any other provided annotation), in addition to measuring the wall thickness at all positions on the midline of the model.</li>
<li>Selecting “Analysis of randomly placed pores” calculates the cell wall thickness at control points (uniformly distributed over the same provided model) equal in number to the annotations provided. “Random number generator id” enables to reproduce results for the controls (generating the same random distributions for that particular model). The same id number needs to be used for such purpose. Every time you will run the plugin - on the same dataset - with that number you will obtain the same control points.</li>
<li>In order to make the data classes (real or “closest” points, the random “simulated” points, and “all points”) independent, you need to press “Remove data points from all points” and “Remove random points from all points”. This ensures that no point from those classes will be included in the other class. * “Mark the distances” displays on the model the distance vectors that are being measured (at plasmodesmata and control positions).</li>
</ul>
<p>Note: if you were to compare the overall cell wall thickness between interfaces (as performed in the paper) you would need to leave all boxes from the option section unclicked.</p>
<ul>
<li>Clicking “Export results to Matlab” displays the resulting values in Matlab. Clicking “Save results in Matlab, Excel or CSV format” conversely allows you to store these values in a file.</li>
<li>“Save centerline thickness map” enables you to save the thinned model as an image, which can then be imported into rendering software.</li>
</ul>
<p><img src="img/wall.png" width="700" /></p>
<p><br></p>
<p>After pressing “Continue”, when the process has finished a new window will appear with visual plots of the wall thickness values for the various categories being requested.</p>
<p><br></p>
</div>
<div id="check-outputs" class="section level1">
<h1>Check outputs</h1>
<p><br></p>
<p>If the plugin has worked correctly and you followed the instructions to calculate the thicknesses at the positions of interest in the models your Data_individual_cells folder should now contain three additional files.</p>
<p>One is <i>*_CellWallThickness_info.txt</i> which is a text document containing info on the datasets. We won’t use this file. There is a <i>*_CellWallThickness.csv</i> file which contains the cell wall thicknesses at real and at an equal number of uniformly distributed control points. The third file <i>*_CellWallThickness_allPoints.csv</i> contains the cell wall thickness at every single point at the midline of our cell wall model.</p>
<p><br> <img src="img/wall_output.png" width="700" /></p>
<p><br></p>
<p>If you want to analyse multiple datasets at the same, as we will do here, the processes described above need to be repeated for each <em>.am</em> file.</p>
<p><br></p>
</div>
<div id="processing-the-thicknesses-in-r" class="section level1">
<h1>Processing the thicknesses in R</h1>
<p><br></p>
<pre class="r"><code>library(tidyverse)
#library(ggbeeswarm) called in the function so no need to load it

# IMPORTANT:
# the working directory is assumed to be the downloaded folder &quot;Data_individual_cells&quot; so paths are given relative to that. Make sure this is also the case in your R environment using the getwd and setwd

#first we can read the files containing all the points (or all other points depending on which options were selected)
Col_allwall &lt;- list.files(path = &quot;.&quot;, pattern = &quot;CellWallThickness_allPoints.csv&quot;) %&gt;%   map_df(function(f){
    x &lt;- read.csv(f) %&gt;% 
      as.data.frame %&gt;% 
      mutate(DatasetFilename = f) %&gt;%
      mutate(Genotype = &quot;Col-0&quot;) %&gt;%
      mutate(Interface = &quot;PPP-EN&quot;) %&gt;%
      mutate(Positions = &quot;All others&quot;)
  })    

#we edit the text of the DatasetFilename column to clean it 
Col_allwall$DatasetFilename &lt;- gsub(&quot;_CellWallThickness_allPoints.csv&quot;, &quot;&quot;, Col_allwall$DatasetFilename)

# we rename the thickness column 
Col_allwall &lt;- Col_allwall %&gt;% rename(&#39;Thickness_um&#39;=&#39;Matrix.of.cell.wall.thickness.values.in.micrometers.for.each.point.of.the.masked.centreline&#39;)

# now we read the files containing thicknesses at real and control points
Col_wall &lt;- list.files(path = &quot;.&quot;, pattern = &quot;CellWallThickness.csv&quot;) %&gt;%   
  map_df(function(f){
    x &lt;- read.csv(f) %&gt;% 
      as.data.frame %&gt;% 
      mutate(DatasetFilename = f) %&gt;%
      mutate(Genotype = &quot;Col-0&quot;) %&gt;%
      mutate(Interface = &quot;PPP-EN&quot;)
  })    

#we edit the text of the DatasetFilename column to clean it 
Col_wall$DatasetFilename &lt;- gsub(&quot;_CellWallThickness.csv&quot;, &quot;&quot;, Col_wall$DatasetFilename)

# we select the data relating to Pd positions (real) 

Col_wall_pd &lt;- select(Col_wall, &quot;Genotype&quot;, &quot;Interface&quot;, &quot;DatasetFilename&quot;, &quot;WallThicknessRealPores_um&quot;) %&gt;%
  # we rename the thickness column so that it will match with the one from all points
  rename(&#39;Thickness_um&#39;=&#39;WallThicknessRealPores_um&#39;) %&gt;%
  # we create a column describing the type of data
  mutate(Positions = &quot;PDs&quot;)

# we do the same for simulated points

Col_wall_sim &lt;- select(Col_wall, &quot;Genotype&quot;, &quot;Interface&quot;, &quot;DatasetFilename&quot;, &quot;WallThicknessRandomPores_um&quot;) %&gt;% 
  rename(&#39;Thickness_um&#39;=&#39;WallThicknessRandomPores_um&#39;) %&gt;%
  mutate(Positions = &quot;Rand. Unif. distributed&quot;)</code></pre>
<pre class="r"><code># we merge the two objects

Col_0 &lt;- rbind(Col_wall_pd, Col_wall_sim, Col_allwall)

# we create a new column with the wall thickness in nm (a better unit for this biological scale) and we also impose an order on the Position classes for visual purposes

Col_0 &lt;- Col_0 %&gt;%
  mutate(&quot;Thickness_nm&quot; = Thickness_um*1000) %&gt;%  
  mutate(Positions = factor(Positions, levels = c(&quot;PDs&quot;, &quot;Rand. Unif. distributed&quot;, &quot;All others&quot;)))

#we are now going to separate the dataset file name in two columns, one containing info on the root and one containing info on the actual cell
# we are going to duplicate the dataset column first
Col_0$Cell = Col_0$DatasetFilename

#in the dataset filename column we remove anything after _DNN
Col_0$DatasetFilename &lt;- gsub(&quot;_PPP.*&quot;,&quot;&quot;, Col_0$DatasetFilename)

# in the column cell we remove anything before the name of the cell
Col_0$Cell &lt;- gsub(&quot;.*PPP&quot;, &quot;PPP&quot;, Col_0$Cell)

# PLOT VALUES FOR ONE CELL

ggplot(data=filter(Col_0, DatasetFilename==&quot;170314_Col_HD_R20_339-381um_DNN&quot; &amp; Cell==&quot;PPP1-EN&quot;), aes(x = Positions, y = Thickness_nm, fill=Positions, colour=Positions)) +  geom_violin(alpha=0.25) + theme_bw() +
  stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median, geom = &quot;crossbar&quot;, size = 0.3, width = 0.4, alpha=1) +
  labs(x = &quot;Positions&quot;, y = &quot;Wall thickness (nm)&quot;) + 
  theme(legend.position = &quot;none&quot;)  +
  # the log scale is useful here because of the range of values
  scale_y_log10() + 
  facet_wrap(DatasetFilename~Cell)</code></pre>
<p><img src="wall_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code># PLOT VALUES FOR MULTIPLE CELLS (and multiple genotypes)

# we summarise the values of thickness for each cell
stats &lt;- Col_0 %&gt;% 
  group_by(Genotype, Interface, DatasetFilename, Cell, Positions) %&gt;% 
  dplyr::summarise(mean_thickness = mean(Thickness_nm))

# we drop the violins from the plot

# we introduce a dodge graphical parameter to better space the groups
dodge &lt;- position_dodge(width = 0.4)

ggplot(data=stats, aes(x = Positions, y = mean_thickness, fill=Genotype, colour=Genotype, group = factor(Genotype))) + theme_bw() +
  stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
               geom = &quot;crossbar&quot;, size = 0.4, width = 0.5, alpha=1, position = dodge) +
  # we differentiate the roots (datasets) via different shapes
  ggbeeswarm::geom_quasirandom(aes(shape=DatasetFilename, fill=Genotype, colour=Genotype), width = 0.2, size= 2, alpha=0.5, dodge.width = 0.8, show.legend = FALSE) +
  labs(x = &quot;Positions&quot;, y = &quot;Wall thickness (nm)&quot;) +
  facet_grid(~Interface) +
  # here the manual scales are a bit redundant but useful when multiple genotypes present
  scale_color_manual(values=c(&quot;#000000&quot;)) +
  scale_fill_manual(values=c(&quot;#000000&quot;)) +
  scale_y_continuous(limits = c(20,180)) +
  scale_shape_manual(values=c(19,17))</code></pre>
<p><img src="wall_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<p>We have reached the end of this guided pipeline. We hope you will employ the tools we developed for the Plasmodesmata community. Please feel free to share feedback!</p>
<p>Good luck with your research!</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
